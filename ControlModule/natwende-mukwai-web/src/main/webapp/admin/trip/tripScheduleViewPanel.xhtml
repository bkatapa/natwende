<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE composition PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<ui:composition xmlns="http://www.w3.org/1999/xhtml"
				xmlns:ui="http://java.sun.com/jsf/facelets"
				xmlns:p="http://primefaces.org/ui"
				xmlns:h="http://java.sun.com/jsf/html"
				xmlns:f="http://java.sun.com/jsf/core">
				
	<p:outputPanel rendered="#{not TripScheduleAction.showMirror}" autoUpdate="true">
		<p:accordionPanel id="editTripSchedule-accordion">
			<p:tab title="Bus(es)">
				<ui:include src="/admin/trip/editBus.xhtml">
					<ui:param name="tripSchedule" value="#{TripScheduleAction.selectedEntity}" />
				</ui:include>
			</p:tab>
			<p:tab title="Assigned driver(es)">
				<ui:include src="/admin/trip/editAssignedDriver.xhtml">
					<ui:param name="tripSchedule" value="#{TripScheduleAction.selectedEntity}" />
					<ui:param name="idPrefix" value="@form:editTripSchedule-accordion" />
				</ui:include>
			</p:tab>
			<p:tab title="Running schedule">
				<ui:include src="/admin/trip/editRunningSchedule.xhtml">
					<ui:param name="tripSchedule" value="#{TripScheduleAction.selectedEntity}" />
				</ui:include>
			</p:tab>
		</p:accordionPanel>
		<p:toolbar style="margin-top: 10px; border: none;">
			<f:facet name="left">
				<p:commandButton value="Cancel"
								 process="@this"			 									 
								 icon="ui-icon-close"
								 iconPos="left"
								 action="#{TripScheduleAction.listEntities}"
								 title="Cancel to go back to trip schedule list.">			 										 
	 			</p:commandButton>						 		
			</f:facet>
			<f:facet name="right">
				<p:commandButton value="Save"			 									 
								 icon="ui-icon-disk"
								 iconPos="left"
								 action="#{TripScheduleAction.saveEntity}"
								 title="Click to save schedule.">			 										 
	 			</p:commandButton>						 		
			</f:facet>
		</p:toolbar>
	</p:outputPanel>
	
	<p:outputPanel rendered="#{TripScheduleAction.showMirror}" autoUpdate="true">
		<p:accordionPanel id="editTripScheduleMirror-accordion" activeIndex="#{TripScheduleAction.activeIndex}">
			<p:tab title="Bus(es)">
				<ui:include src="/admin/trip/editBus.xhtml">
					<ui:param name="tripSchedule" value="#{TripScheduleAction.mirrorSchedule}" />
				</ui:include>
				<p:toolbar style="margin-bottom: 5px; border: none; margin-top: 30px;">
					<f:facet name="right">
						<p:commandButton value="Assigned driver(s)"
										 process="@this"			 									 
										 icon="ui-icon-arrowthick-1-e"
										 iconPos="right"
										 actionListener="#{TripScheduleAction.assignedDriversToBuses}"
										 title="View drivers and their assigned buses.">
				 			<f:setPropertyActionListener value="1" target="#{TripScheduleAction.activeIndex}" />			 										 
			 			</p:commandButton>						 		
					</f:facet>
				</p:toolbar>
			</p:tab>
			<p:tab title="Assigned driver(es)">
				<ui:include src="/admin/trip/editAssignedDriver.xhtml">
					<ui:param name="tripSchedule" value="#{TripScheduleAction.mirrorSchedule}" />
					<ui:param name="idPrefix" value="tripScheduleEdit-form:editTripSchedule-accordion" />
				</ui:include>
			</p:tab>
			<p:tab title="Running schedule">
				<ui:include src="/admin/trip/editRunningSchedule.xhtml">
					<ui:param name="tripSchedule" value="#{TripScheduleAction.mirrorSchedule}" />
				</ui:include>
			</p:tab>
		</p:accordionPanel>
		<p:toolbar style="margin-top: 10px; border: none;">
			<f:facet name="left">
				<p:commandButton value="Done"
								 process="@this"
								 update="@form"			 									 
								 icon="ui-icon-check"
								 oncomplete="PF('var_TripScheduleEditDlg').hide();"
								 title="Click to close window.">			 										 
	 			</p:commandButton>						 		
			</f:facet>			
		</p:toolbar>
	</p:outputPanel>				
				
</ui:composition>